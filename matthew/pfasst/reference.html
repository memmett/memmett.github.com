

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reference &mdash; PFASST v0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <link rel="top" title="PFASST v0.1.0 documentation" href="index.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="overview.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PFASST v0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<p>Throughout the PyPFASST documentation, <em>F</em> and <em>G</em> refer to fine and
coarse levels.</p>
<div class="section" id="top-level-classes">
<h2>Top-level classes<a class="headerlink" href="#top-level-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pfasst-class">
<h3>PFASST class<a class="headerlink" href="#pfasst-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.pfasst.PFASST">
<em class="property">class </em><tt class="descclassname">pfasst.pfasst.</tt><tt class="descname">PFASST</tt><a class="headerlink" href="#pfasst.pfasst.PFASST" title="Permalink to this definition">¶</a></dt>
<dd><p>Main PFASST class/driver.</p>
<p>Attributes:</p>
<dl class="attribute">
<dt id="PFASST.levels">
<tt class="descname">levels</tt><a class="headerlink" href="#PFASST.levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of PFASST levels.  See <a class="reference internal" href="#pfasst.pfasst.PFASST.add_level" title="pfasst.pfasst.PFASST.add_level"><tt class="xref py py-meth docutils literal"><span class="pre">add_level()</span></tt></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.mpi">
<tt class="descname">mpi</tt><a class="headerlink" href="#PFASST.mpi" title="Permalink to this definition">¶</a></dt>
<dd><p>PFASST MPI helper class.  See <a class="reference internal" href="#pfasst.mpi.PFASSTMPI" title="pfasst.mpi.PFASSTMPI"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.mpi.PFASSTMPI</span></tt></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.state">
<tt class="descname">state</tt><a class="headerlink" href="#PFASST.state" title="Permalink to this definition">¶</a></dt>
<dd><p>PFASST state class.  See <a class="reference internal" href="#pfasst.state.State" title="pfasst.state.State"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.state.State</span></tt></a>.</p>
</dd></dl>

<p>Each PFASST level contains the following state arrays:</p>
<dl class="attribute">
<dt id="PFASST.q0">
<tt class="descname">q0</tt><a class="headerlink" href="#PFASST.q0" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of initial conditions.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.qend">
<tt class="descname">qend</tt><a class="headerlink" href="#PFASST.qend" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of final values.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.tau">
<tt class="descname">tau</tt><a class="headerlink" href="#PFASST.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of FAS corrections.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.qSDC">
<tt class="descname">qSDC</tt><a class="headerlink" href="#PFASST.qSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of unknowns at each SDC node.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.fSDC">
<tt class="descname">fSDC</tt><a class="headerlink" href="#PFASST.fSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of function values at each SDC node.</p>
</dd></dl>

<p>Each PFASST level also has the following attributes:</p>
<dl class="attribute">
<dt id="PFASST.feval">
<tt class="descname">feval</tt><a class="headerlink" href="#PFASST.feval" title="Permalink to this definition">¶</a></dt>
<dd><p>Function evaluator (see <a class="reference internal" href="#pfasst.feval.FEval" title="pfasst.feval.FEval"><tt class="xref py py-class docutils literal"><span class="pre">FEval</span></tt></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.sdc">
<tt class="descname">sdc</tt><a class="headerlink" href="#PFASST.sdc" title="Permalink to this definition">¶</a></dt>
<dd><p>SDC integrator (see <a class="reference internal" href="#pfasst.sdc.SDC" title="pfasst.sdc.SDC"><tt class="xref py py-class docutils literal"><span class="pre">SDC</span></tt></a>).</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.interpolate">
<tt class="descname">interpolate</tt><a class="headerlink" href="#PFASST.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolator (see below).</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.restrict">
<tt class="descname">restrict</tt><a class="headerlink" href="#PFASST.restrict" title="Permalink to this definition">¶</a></dt>
<dd><p>Restrictor (see below).</p>
</dd></dl>

<p>The <em>state</em> attribute has the following attributes:</p>
<dl class="attribute">
<dt id="PFASST.cycle">
<tt class="descname">cycle</tt><a class="headerlink" href="#PFASST.cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Current position in the PFASST multi-level cycle.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.iteration">
<tt class="descname">iteration</tt><a class="headerlink" href="#PFASST.iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Current PFASST iteration.</p>
</dd></dl>

<dl class="attribute">
<dt id="PFASST.predictor">
<tt class="descname">predictor</tt><a class="headerlink" href="#PFASST.predictor" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we&#8217;re currently in the predictor.</p>
</dd></dl>

<p>Keep in mind that:</p>
<ul>
<li><p class="first">Level 0 is considered the <em>finest</em> level.</p>
</li>
<li><p class="first">The interpolate routine at level <em>N</em> (= <em>iF</em>) is called to
interpolate from level <em>N+1</em> (= <em>iG</em>) to <em>N</em>.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">levels</span><span class="p">[</span><span class="n">iF</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">yF</span><span class="p">,</span> <span class="n">yG</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">fevalF</span><span class="o">=</span><span class="n">levels</span><span class="p">[</span><span class="n">iF</span><span class="p">]</span><span class="o">.</span><span class="n">feval</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">fevalG</span><span class="o">=</span><span class="n">levels</span><span class="p">[</span><span class="n">iG</span><span class="p">]</span><span class="o">.</span><span class="n">feval</span><span class="p">)</span>
</pre></div>
</div>
<p>interpolates the coarse y values in <em>yG</em> at level <em>iG</em> to level
<em>iF</em> and stores the result in <em>yF</em>.</p>
</li>
<li><p class="first">The restrict routine at level <em>N</em> is called to restrict from
<em>level N</em> to level <em>N+1</em>.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">levels</span><span class="p">[</span><span class="n">iF</span><span class="p">]</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">yF</span><span class="p">,</span> <span class="n">yG</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="n">fevalF</span><span class="o">=</span><span class="n">levels</span><span class="p">[</span><span class="n">iF</span><span class="p">]</span><span class="o">.</span><span class="n">feval</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="n">fevalG</span><span class="o">=</span><span class="n">levels</span><span class="p">[</span><span class="n">iG</span><span class="p">]</span><span class="o">.</span><span class="n">feval</span><span class="p">)</span>
</pre></div>
</div>
<p>restricts the fine y values in <em>yF</em> at level <em>iF</em> to level <em>iG</em>
and stores the result in <em>yG</em>.</p>
</li>
<li><p class="first">PFASST takes care of computing increments and calling your
interpolation routines to interpolate increments.  <strong>Your
interpolation routines don&#8217;t need to compute increments.</strong></p>
</li>
</ul>
<dl class="method">
<dt id="pfasst.pfasst.PFASST.run">
<tt class="descname">run</tt><big>(</big><em>q0=None</em>, <em>dt=None</em>, <em>tend=None</em>, <em>iterations=12</em>, <em>RK=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.pfasst.PFASST.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the PFASST solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>q0</strong> &#8211; initial condition (flat numpy array, real or complex)</li>
<li><strong>dt</strong> &#8211; time step (float)</li>
<li><strong>tend</strong> &#8211; final time (float)</li>
<li><strong>iterations</strong> &#8211; number of PFASST iterations (integer)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Any other keyward arguments are cascaded down through all
subsequent function calls (ie, the evaluators, interpolators,
restrictors, hooks etc).  This allows you to pass quick&#8217;n&#8217;dirty
options to your functions.</p>
<p>If only one level has been added, this uses a serial SDC algorithm
to integrate in time.</p>
<p>If more than one level has been added, this uses the PFASST
algorithm to integrate in time.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.pfasst.PFASST.add_level">
<tt class="descname">add_level</tt><big>(</big><em>feval</em>, <em>sdc</em>, <em>interpolate=None</em>, <em>restrict=None</em><big>)</big><a class="headerlink" href="#pfasst.pfasst.PFASST.add_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a level to the PFASST hierarchy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>feval</strong> &#8211; implicit/explicit function evaluator (instance
of <a class="reference internal" href="#pfasst.feval.FEval" title="pfasst.feval.FEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.feval.FEval</span></tt></a>)</li>
<li><strong>sdc</strong> &#8211; implicit/explicit SDC sweeper (instance
of <a class="reference internal" href="#pfasst.sdc.SDC" title="pfasst.sdc.SDC"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.sdc.SDC</span></tt></a>)</li>
<li><strong>interpolate</strong> &#8211; interpolate from coarser level to this
level (callable)</li>
<li><strong>restrict</strong> &#8211; restrict from this level to coarser level
(callable)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Levels should be added from finest (level 0) to coarest.</p>
<p>The <em>interpolate</em> callable is called as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">interpolate</span><span class="p">(</span><span class="n">yF</span><span class="p">,</span> <span class="n">yG</span><span class="p">,</span> <span class="n">fevalF</span><span class="o">=</span><span class="n">fevaF</span><span class="p">,</span> <span class="n">fevalG</span><span class="o">=</span><span class="n">fevalG</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>and should interpolate the coarse y values <em>yG</em> that
correspond to the coarse evaluator <em>fevalG</em> to the fine y
values <em>yF</em> that correspond to the fine evaluator <em>fevalF</em>.
The (flattened) result should be stored in <em>yF</em>.</p>
<p>The <em>restrict</em> callable is called as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">restrict</span><span class="p">(</span><span class="n">yF</span><span class="p">,</span> <span class="n">yG</span><span class="p">,</span> <span class="n">fevalF</span><span class="o">=</span><span class="n">fevalF</span><span class="p">,</span> <span class="n">fevalG</span><span class="o">=</span><span class="n">fevalG</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>and should restrict the fine y values <em>yF</em> that correspond to
the fine evaluator <em>fevalF</em> to the coarse y values <em>yG</em> that
correspond to the coarse evaluator <em>fevalG</em>.  The (flattened)
result should be stored in <em>yG</em>.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.pfasst.PFASST.add_hook">
<tt class="descname">add_hook</tt><big>(</big><em>level</em>, <em>location</em>, <em>hook</em><big>)</big><a class="headerlink" href="#pfasst.pfasst.PFASST.add_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a hook to be called for, eg, diagnostics or output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>level</strong> &#8211; PFASST level (integer)</li>
<li><strong>location</strong> &#8211; location in the algorithm (string)</li>
<li><strong>hook</strong> &#8211; callable</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Valid locations are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'pre-predictor'</span></tt>: hook called before the predictor (only
called at the coarsest level);</li>
<li><tt class="docutils literal"><span class="pre">'post-predictor'</span></tt>: hook called after the predictor (only
called at the coarsest level);</li>
<li><tt class="docutils literal"><span class="pre">'pre-iteration'</span></tt>: hook called at the beginning of each PFASST
iteration (only called at the finest level);</li>
<li><tt class="docutils literal"><span class="pre">'post-iteration'</span></tt>: hook called after each PFASST iteration
(only called at the finest level);</li>
<li><tt class="docutils literal"><span class="pre">'end-step'</span></tt>: hook called at the end of each time step (only
called at the finest level);</li>
<li><tt class="docutils literal"><span class="pre">'pre-sweep'</span></tt>: hook called before each SDC sweep;</li>
<li><tt class="docutils literal"><span class="pre">'post-sweep'</span></tt>: hook called after each SDC sweep;</li>
<li><tt class="docutils literal"><span class="pre">'pre-restrict'</span></tt>: hook called before restricting in time and
space;</li>
<li><tt class="docutils literal"><span class="pre">'post-restrict'</span></tt>: hook called after restricting in time and
space;</li>
<li><tt class="docutils literal"><span class="pre">'pre-interpolate'</span></tt>: hook called before interpolating in time
and space;</li>
<li><tt class="docutils literal"><span class="pre">'post-interpolate'</span></tt>: hook called after interpolating in time
and space;</li>
</ul>
<p>The callable <tt class="docutils literal"><span class="pre">hook</span></tt> is passed two arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>level</strong> &#8211; PFASST level</li>
<li><strong>state</strong> &#8211; PFASST state</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pfasst.pfasst.PFASST.simple_communicators">
<tt class="descname">simple_communicators</tt><big>(</big><em>nspace=1</em>, <em>ntime=1</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object at 0x34d30d8&gt;</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.pfasst.PFASST.simple_communicators" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the MPI communicators using simple colouring.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="feval-class">
<h3>FEval class<a class="headerlink" href="#feval-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.feval.FEval">
<em class="property">class </em><tt class="descclassname">pfasst.feval.</tt><tt class="descname">FEval</tt><a class="headerlink" href="#pfasst.feval.FEval" title="Permalink to this definition">¶</a></dt>
<dd><p>Function evaluation base class.</p>
<p>Methods in this class should be overridden with problem specific
evaluators.  Each instance of the class is associated with a
PFASST level.  The shape of the unknowns associated with this
evaluator/level should be stored in the instance variable <em>shape</em>.
The total number of unknowns associated with this evaluator/level
should be stored in the instance variable <em>size</em> (note also that
<em>size</em> should be the product of <em>shape</em>).  If the function is
broken into several pieces (ie, explicit and pieces), then the
number of pieces should be stored in the instance variable
<em>pieces</em> (each piece has shape <em>shape</em> and size <em>size</em>).</p>
<p>See also <a class="reference internal" href="#pfasst.explicit.ExplicitFEval" title="pfasst.explicit.ExplicitFEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.explicit.ExplicitFEval</span></tt></a> and
<a class="reference internal" href="#pfasst.imex.IMEXFEval" title="pfasst.imex.IMEXFEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.imex.IMEXFEval</span></tt></a>.</p>
<p>Attributes:</p>
<dl class="attribute">
<dt id="FEval.pieces">
<tt class="descname">pieces</tt><a class="headerlink" href="#FEval.pieces" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of function evaluation pieces.  For example, for a
purely explicit time stepper, this would 1, and for an
implicit/explicit time stepper, this would be 2.</p>
</dd></dl>

<dl class="attribute">
<dt id="FEval.shape">
<tt class="descname">shape</tt><a class="headerlink" href="#FEval.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the unknowns associated with this evaluator.</p>
</dd></dl>

<dl class="attribute">
<dt id="FEval.size">
<tt class="descname">size</tt><a class="headerlink" href="#FEval.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unknown associated with this evaluator (this should
be the product of the <em>shape</em> attribute).</p>
</dd></dl>

<dl class="attribute">
<dt id="FEval.forcing">
<tt class="descname">forcing</tt><a class="headerlink" href="#FEval.forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to compute time-dependent forcing (efficiently).  Called as:</p>
<blockquote>
<div>feval.forcing(t, f, <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs)</div></blockquote>
<p>where t is time and f is where the force should be stored.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.feval.FEval.evaluate">
<tt class="descname">evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.feval.FEval.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate function values <em>f(y, t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; y (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>f</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The result should be stored in <em>f</em>.</p>
<p><strong>This method should be overridden.</strong></p>
<p>By default, this sets <em>f</em> to 0.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sdc-class">
<h3>SDC class<a class="headerlink" href="#sdc-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.sdc.SDC">
<em class="property">class </em><tt class="descclassname">pfasst.sdc.</tt><tt class="descname">SDC</tt><big>(</big><em>qtype</em>, <em>nnodes</em>, <em>refine=1</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><big>)</big><a class="headerlink" href="#pfasst.sdc.SDC" title="Permalink to this definition">¶</a></dt>
<dd><p>SDC base class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qtype</strong> &#8211; quadrature type</li>
<li><strong>nodes</strong> &#8211; number of quadrature nodes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The SDC class performs SDC sweeps and adds FAS corrections if
supplied.  See also <a class="reference internal" href="#pfasst.imex.IMEXSDC" title="pfasst.imex.IMEXSDC"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.imex.IMEXSDC</span></tt></a>.</p>
<p>Currently supported quadrature types are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'GL'</span></tt>: Gauss-Labotto</li>
<li><tt class="docutils literal"><span class="pre">'CC'</span></tt>: Clenshaw-Curtis</li>
</ul>
<p>By default, the constructor loads the quadrature nodes and
spectral integration matrix correcponding to <em>nodes</em> and <em>qtype</em>
into the instance variables <em>nodes</em> and <em>smat</em>.</p>
<dl class="method">
<dt id="pfasst.sdc.SDC.residual">
<tt class="descname">residual</tt><big>(</big><em>q0</em>, <em>qend</em>, <em>dt</em>, <em>fSDC</em>, <em>feval</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.sdc.SDC.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residual of <em>fSDC</em>.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.sdc.SDC.sweep">
<tt class="descname">sweep</tt><big>(</big><em>b</em>, <em>t0</em>, <em>dt</em>, <em>qSDC</em>, <em>fSDC</em>, <em>feval</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.sdc.SDC.sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one SDC sweep.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>b</strong> &#8211; right hand side (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,</span> <span class="pre">size)</span></tt>)</li>
<li><strong>t0</strong> &#8211; initial time</li>
<li><strong>dt</strong> &#8211; time step</li>
<li><strong>qSDC</strong> &#8211; solution (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,</span> <span class="pre">size)</span></tt>)</li>
<li><strong>fSDC</strong> &#8211; function (numpy array of size <tt class="docutils literal"><span class="pre">(pieces,</span> <span class="pre">nnodes,</span> <span class="pre">size)</span></tt>)</li>
<li><strong>feval</strong> &#8211; function evaluator (instance of
<a class="reference internal" href="#pfasst.feval.FEval" title="pfasst.feval.FEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.feval.FEval</span></tt></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>This method should be overridden.</strong></p>
<p>See also <a class="reference internal" href="#pfasst.imex.IMEXSDC" title="pfasst.imex.IMEXSDC"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.imex.IMEXSDC</span></tt></a> and
<a class="reference internal" href="#pfasst.explicit.ExplicitSDC" title="pfasst.explicit.ExplicitSDC"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.explicit.ExplicitSDC</span></tt></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="level-class">
<h3>Level class<a class="headerlink" href="#level-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.level.Level">
<em class="property">class </em><tt class="descclassname">pfasst.level.</tt><tt class="descname">Level</tt><a class="headerlink" href="#pfasst.level.Level" title="Permalink to this definition">¶</a></dt>
<dd><p>PyPFASST level class.</p>
<p>Attributes:</p>
<dl class="attribute">
<dt id="Level.qSDC">
<tt class="descname">qSDC</tt><a class="headerlink" href="#Level.qSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>The unknown at each SDC node.</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.q0">
<tt class="descname">q0</tt><a class="headerlink" href="#Level.q0" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial condition (received from the previous time processor).</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.qend">
<tt class="descname">qend</tt><a class="headerlink" href="#Level.qend" title="Permalink to this definition">¶</a></dt>
<dd><p>Final value (sent to the next time processor).</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.fSDC">
<tt class="descname">fSDC</tt><a class="headerlink" href="#Level.fSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>The function evaluations at each SDC node.</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.bSDC">
<tt class="descname">bSDC</tt><a class="headerlink" href="#Level.bSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>The RHS for SDC sweeps (the initial conditions and FAS
corrections are used to form the RHS).</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.gSDC">
<tt class="descname">gSDC</tt><a class="headerlink" href="#Level.gSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent forcing evaluations at each SDC node.</p>
</dd></dl>

<dl class="attribute">
<dt id="Level.forcing">
<tt class="descname">forcing</tt><a class="headerlink" href="#Level.forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time dependent forcing is present.</p>
</dd></dl>

<p>See the <a class="reference internal" href="#pfasst.pfasst.PFASST.add_level" title="pfasst.pfasst.PFASST.add_level"><tt class="xref py py-meth docutils literal"><span class="pre">add_level()</span></tt></a> and
<a class="reference internal" href="#pfasst.runner.Runner.allocate" title="pfasst.runner.Runner.allocate"><tt class="xref py py-meth docutils literal"><span class="pre">allocate()</span></tt></a> methods for more
details.</p>
<dl class="method">
<dt id="pfasst.level.Level.call_hooks">
<tt class="descname">call_hooks</tt><big>(</big><em>key</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.level.Level.call_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Call hooks.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.level.Level.post_receive">
<tt class="descname">post_receive</tt><big>(</big><em>tag</em><big>)</big><a class="headerlink" href="#pfasst.level.Level.post_receive" title="Permalink to this definition">¶</a></dt>
<dd><p>Post a receive request.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.level.Level.receive">
<tt class="descname">receive</tt><big>(</big><em>tag</em>, <em>blocking=False</em>, <em>ignore=False</em><big>)</big><a class="headerlink" href="#pfasst.level.Level.receive" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive q0 from the previous time processor.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.level.Level.send">
<tt class="descname">send</tt><big>(</big><em>tag</em>, <em>blocking=False</em><big>)</big><a class="headerlink" href="#pfasst.level.Level.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send qend forward to the next time processor.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="helpers">
<h2>Helpers<a class="headerlink" href="#helpers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pfasst.imex">
<span id="imex"></span><h3>IMEX<a class="headerlink" href="#module-pfasst.imex" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST IMEX SDC and FEval classes.  These classes are used for
ODEs of the form</p>
<div class="math">
\[\frac{d}{dt} y(x,t) = f(y,t) = f_1(y,t) + f_2(y,t) + b(t)\]</div>
<p>where the solver treats the <span class="math">\(f_1\)</span> piece explicitly, and the
<span class="math">\(f_2\)</span> piece implicitly.</p>
<dl class="class">
<dt id="pfasst.imex.IMEXFEval">
<em class="property">class </em><tt class="descclassname">pfasst.imex.</tt><tt class="descname">IMEXFEval</tt><a class="headerlink" href="#pfasst.imex.IMEXFEval" title="Permalink to this definition">¶</a></dt>
<dd><p>IMEX function evaluation base class.</p>
<p>The explicit piece is <em>f1</em>.  The implicit piece is <em>f2</em>.</p>
<dl class="method">
<dt id="pfasst.imex.IMEXFEval.evaluate">
<tt class="descname">evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXFEval.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate function values <em>f(y, t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; y (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>f</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The result is stored in <em>f</em>.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.imex.IMEXFEval.f1_evaluate">
<tt class="descname">f1_evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f1</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXFEval.f1_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate explicit function <em>f1(y, t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; y (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>f1</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The result is stored in <em>f1</em>.</p>
<p>By default, this sets <em>f1</em> to 0.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.imex.IMEXFEval.f2_evaluate">
<tt class="descname">f2_evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f2</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXFEval.f2_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate implicit function <em>f2(y, t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; y (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>f2</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The result is stored in <em>f2</em>.</p>
<p>By default, this is sets <em>f2</em> to 0.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.imex.IMEXFEval.f2_solve">
<tt class="descname">f2_solve</tt><big>(</big><em>rhs</em>, <em>y</em>, <em>t</em>, <em>dt</em>, <em>f2</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXFEval.f2_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve implicit equation <em>f2(y,t+dt) = rhs</em> and evaluate
implicit function <em>f2(y,t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rhs</strong> &#8211; right hand side (numpy array)</li>
<li><strong>y</strong> &#8211; y result (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>dt</strong> &#8211; time step (float)</li>
<li><strong>f2</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The solution is stored in <em>y</em>, and the result is stored in <em>f2</em>.</p>
<p>By default, this sets <em>y</em> to <em>rhs</em> and <em>f2</em> to 0.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pfasst.imex.IMEXSDC">
<em class="property">class </em><tt class="descclassname">pfasst.imex.</tt><tt class="descname">IMEXSDC</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>IMEXSDC (implicit/explicit SDC) class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qtype</strong> &#8211; quadrature type</li>
<li><strong>nodes</strong> &#8211; number of quadrature nodes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The SDC class performs implicit/explicit SDC sweeps and adds FAS
corrections if supplied.</p>
<p>Currently supported quadrature types are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'GL'</span></tt>: Gauss-Labotto</li>
<li><tt class="docutils literal"><span class="pre">'CC'</span></tt>: Clenshaw-Curtis</li>
</ul>
<dl class="method">
<dt id="pfasst.imex.IMEXSDC.sweep">
<tt class="descname">sweep</tt><big>(</big><em>b</em>, <em>t0</em>, <em>dt</em>, <em>qSDC</em>, <em>fSDC</em>, <em>feval</em>, <em>gSDC=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.imex.IMEXSDC.sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one SDC sweep.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>b</strong> &#8211; right hand side (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,nqvar)</span></tt>)</li>
<li><strong>t0</strong> &#8211; initial time</li>
<li><strong>dt</strong> &#8211; time step</li>
<li><strong>qSDC</strong> &#8211; solution (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,nqvar)</span></tt>)</li>
<li><strong>fSDC</strong> &#8211; function (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,nfvar)</span></tt>)</li>
<li><strong>feval</strong> &#8211; implicit/explicit function evaluator (instance
of <a class="reference internal" href="#pfasst.feval.FEval" title="pfasst.feval.FEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.feval.FEval</span></tt></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Note that <em>qSDC</em> and <em>fSDC</em> are over-written.</p>
<p>The sweep performed uses forward/backward Euler time-stepping:</p>
<div class="math">
\[\begin{split}\begin{multline}
  q^{k+1}_{m+1} = q^{k+1}_m + \Delta t_m
      \bigl[ f_I(t_{m+1}, q^{k+1}_{m+1}) +
           f_E(t_{m}, q^{k+1}_{m}) \bigr] \\
  + S^{m,m+1}_E \, f_E(\vec{t}, \vec{q}^{k})
  + S^{m,m+1}_I \, f_I(\vec{t}, \vec{q}^{k}) + b_{m+1}
\end{multline}\end{split}\]</div>
<p>where <span class="math">\(m = 0 \ldots M\)</span>.  Note that the initial condition
<span class="math">\(q^{k+1}_0\)</span> is assumed to be stored in <tt class="docutils literal"><span class="pre">b[0]</span></tt>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pfasst.explicit">
<span id="explicit"></span><h3>Explicit<a class="headerlink" href="#module-pfasst.explicit" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST explicit SDC and FEval classes.  These classes are used for
ODEs of the form</p>
<div class="math">
\[\frac{d}{dt} y(x,t) = f(y,t) + b(t)\]</div>
<p>where the solver treats <span class="math">\(f\)</span> explicitly.</p>
<dl class="class">
<dt id="pfasst.explicit.ExplicitFEval">
<em class="property">class </em><tt class="descclassname">pfasst.explicit.</tt><tt class="descname">ExplicitFEval</tt><a class="headerlink" href="#pfasst.explicit.ExplicitFEval" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicit function evaluation base class.</p>
<dl class="method">
<dt id="pfasst.explicit.ExplicitFEval.evaluate">
<tt class="descname">evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.explicit.ExplicitFEval.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate function values <em>f(y, t)</em>.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.explicit.ExplicitFEval.f1_evaluate">
<tt class="descname">f1_evaluate</tt><big>(</big><em>y</em>, <em>t</em>, <em>f</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.explicit.ExplicitFEval.f1_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate function values <em>f(y, t)</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; y (numpy array)</li>
<li><strong>t</strong> &#8211; time (float)</li>
<li><strong>f</strong> &#8211; result (numpy array)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pfasst.explicit.ExplicitSDC">
<em class="property">class </em><tt class="descclassname">pfasst.explicit.</tt><tt class="descname">ExplicitSDC</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.explicit.ExplicitSDC" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicit SDC class.</p>
<p>This SDC class performs explicit SDC sweeps and adds FAS corrections
if supplied.</p>
<dl class="method">
<dt id="pfasst.explicit.ExplicitSDC.sweep">
<tt class="descname">sweep</tt><big>(</big><em>b</em>, <em>t0</em>, <em>dt</em>, <em>qSDC</em>, <em>fSDC</em>, <em>feval</em>, <em>gSDC=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.explicit.ExplicitSDC.sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one SDC sweep.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t0</strong> &#8211; initial time</li>
<li><strong>b</strong> &#8211; right hand side (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,...)</span></tt>)</li>
<li><strong>dt</strong> &#8211; time step</li>
<li><strong>qSDC</strong> &#8211; solution (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,...)</span></tt>)</li>
<li><strong>fSDC</strong> &#8211; function (numpy array of size <tt class="docutils literal"><span class="pre">(nnodes,...)</span></tt>)</li>
<li><strong>feval</strong> &#8211; implicit/explicit function evaluator (instance
of <a class="reference internal" href="#pfasst.feval.FEval" title="pfasst.feval.FEval"><tt class="xref py py-class docutils literal"><span class="pre">pfasst.feval.FEval</span></tt></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Note that <em>qSDC</em> and <em>fSDC</em> are over-written.</p>
<p>The sweep performed uses forward Euler time-stepping:</p>
<div class="math">
\[q^{k+1}_{m+1} = q^{k+1}_m
                + \Delta t_m f(t_m, q^{k+1}_m)
                + S_m^{m+1} \, f(\vec{t}, \vec{q}^k)
                + b_{m+1}\]</div>
<p>where <span class="math">\(m = 0 \ldots M\)</span>.  Note that the initial condition
<span class="math">\(q^{k+1}_0\)</span> is assumed to be stored in <tt class="docutils literal"><span class="pre">b[0]</span></tt>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mpi">
<h3>MPI<a class="headerlink" href="#mpi" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.mpi.PFASSTMPI">
<em class="property">class </em><tt class="descclassname">pfasst.mpi.</tt><tt class="descname">PFASSTMPI</tt><a class="headerlink" href="#pfasst.mpi.PFASSTMPI" title="Permalink to this definition">¶</a></dt>
<dd><p>PFASST MPI helpers.</p>
<p>Attributes:</p>
<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.nspace">
<tt class="descname">nspace</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.nspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spatial processors.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.ntime">
<tt class="descname">ntime</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.ntime" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time processors.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.space">
<tt class="descname">space</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.space" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial MPI communicator.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.comm">
<tt class="descname">comm</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.comm" title="Permalink to this definition">¶</a></dt>
<dd><p>Time MPI communicator.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.forward">
<tt class="descname">forward</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward in time MPI rank.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.backward">
<tt class="descname">backward</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Backward in time MPI rank.</p>
</dd></dl>

<dl class="attribute">
<dt id="pfasst.explicit.PFASSTMPI.rank">
<tt class="descname">rank</tt><a class="headerlink" href="#pfasst.explicit.PFASSTMPI.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Time MPI rank.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.mpi.PFASSTMPI.create_simple_communicators">
<tt class="descname">create_simple_communicators</tt><big>(</big><em>nspace</em>, <em>ntime</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object at 0x34d30d8&gt;</em><big>)</big><a class="headerlink" href="#pfasst.mpi.PFASSTMPI.create_simple_communicators" title="Permalink to this definition">¶</a></dt>
<dd><p>Create MPI communicators using simple colouring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nspace</strong> &#8211; number of spatial processors</li>
<li><strong>ntime</strong> &#8211; number of time processors</li>
<li><strong>comm</strong> &#8211; base communicator (defaults to MPI.COMM_WORLD)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Creates MPI communicators so that there are <em>ntime</em> groups of
<em>nspace</em> processors.  Within each spatial group, the proceccors are
intraconnected through the <tt class="docutils literal"><span class="pre">space</span></tt> communicator.  Each processor
in a spatial group is connected to its equivalent processors (ie,
same spatial rank) in time through the <tt class="docutils literal"><span class="pre">forward</span></tt> and <tt class="docutils literal"><span class="pre">backward</span></tt>
source/destination rank.</p>
<p>The above is summarised by:</p>
<div class="highlight-python"><pre>color 0:        rank 0  &lt;-- space --&gt; ... &lt;-- space --&gt;  rank nspace-1
                              |                 ^
                              |                 |
                           forward           backward
                              |                 |
                              v                 |
color ntime-1:  rank 0  &lt;-- space --&gt; ... &lt;-- space --&gt;  rank nspace-1</pre>
</div>
<p>Finally, the <tt class="docutils literal"><span class="pre">forward</span></tt> and <tt class="docutils literal"><span class="pre">backward</span></tt> ranks are cyclic.  That
is, a message send forward from color <tt class="docutils literal"><span class="pre">ntime-1</span></tt> is received by
color <tt class="docutils literal"><span class="pre">0</span></tt>, and visa versa.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="low-level-routines-guts">
<h2>Low-level routines (guts)<a class="headerlink" href="#low-level-routines-guts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pfasst.interpolate">
<span id="interpolate"></span><h3>Interpolate<a class="headerlink" href="#module-pfasst.interpolate" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST interpolation routines.</p>
<dl class="function">
<dt id="pfasst.interpolate.interpolate_correction">
<tt class="descclassname">pfasst.interpolate.</tt><tt class="descname">interpolate_correction</tt><big>(</big><em>qF</em>, <em>qG</em>, <em>F</em>, <em>G</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.interpolate.interpolate_correction" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Adjust</strong> <em>qF</em> by interpolating the <em>qG</em> correction.</p>
<p>The different between <em>qG</em> and <em>qF</em> (after restricting) is
interpolated and added to <em>qF</em>.</p>
</dd></dl>

<dl class="function">
<dt id="pfasst.interpolate.interpolate_correction_time_space">
<tt class="descclassname">pfasst.interpolate.</tt><tt class="descname">interpolate_correction_time_space</tt><big>(</big><em>qSDCF</em>, <em>qSDCG</em>, <em>F</em>, <em>G</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.interpolate.interpolate_correction_time_space" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Adjust</strong> <em>qSDCF</em> by interpolating the <em>qSDCG</em> correction in
both space and time.</p>
</dd></dl>

<dl class="function">
<dt id="pfasst.interpolate.time_interpolation_matrix">
<tt class="descclassname">pfasst.interpolate.</tt><tt class="descname">time_interpolation_matrix</tt><big>(</big><em>nodesF</em>, <em>nodesG</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><big>)</big><a class="headerlink" href="#pfasst.interpolate.time_interpolation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomial interpolation matrix required to
interpolate values to missing SDC nodes between levels.</p>
</dd></dl>

</div>
<div class="section" id="module-pfasst.restrict">
<span id="restrict"></span><h3>Restrict<a class="headerlink" href="#module-pfasst.restrict" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST restrict routines.</p>
<dl class="function">
<dt id="pfasst.restrict.restrict_space_sum_time">
<tt class="descclassname">pfasst.restrict.</tt><tt class="descname">restrict_space_sum_time</tt><big>(</big><em>qSDCF</em>, <em>qSDCG</em>, <em>F</em>, <em>G</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.restrict.restrict_space_sum_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Restrict <em>qSDCF</em> in space and sum fine nodes (excluding the
first) in between the coarse nodes in time.</p>
</dd></dl>

<dl class="function">
<dt id="pfasst.restrict.restrict_time_space">
<tt class="descclassname">pfasst.restrict.</tt><tt class="descname">restrict_time_space</tt><big>(</big><em>qSDCF</em>, <em>qSDCG</em>, <em>F</em>, <em>G</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.restrict.restrict_time_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Restrict <em>qSDCF</em> in both time and space and store the
result in <em>qSDCG</em>.</p>
</dd></dl>

</div>
<div class="section" id="state">
<h3>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pfasst.state.State">
<em class="property">class </em><tt class="descclassname">pfasst.state.</tt><tt class="descname">State</tt><a class="headerlink" href="#pfasst.state.State" title="Permalink to this definition">¶</a></dt>
<dd><p>PyPFASST state container/namespace.</p>
</dd></dl>

</div>
<div class="section" id="module-pfasst.fas">
<span id="fas"></span><h3>FAS<a class="headerlink" href="#module-pfasst.fas" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST FAS routines.</p>
<dl class="function">
<dt id="pfasst.fas.fas">
<tt class="descclassname">pfasst.fas.</tt><tt class="descname">fas</tt><big>(</big><em>dt</em>, <em>fSDCF</em>, <em>fSDCG</em>, <em>F</em>, <em>G</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.fas.fas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return FAS correction between <em>fSDCF</em> and <em>fSDCG</em>.</p>
</dd></dl>

</div>
<div class="section" id="module-pfasst.runner">
<span id="runners"></span><h3>Runners<a class="headerlink" href="#module-pfasst.runner" title="Permalink to this headline">¶</a></h3>
<p>PyPFASST Runner class.</p>
<dl class="class">
<dt id="pfasst.runner.Runner">
<em class="property">class </em><tt class="descclassname">pfasst.runner.</tt><tt class="descname">Runner</tt><a class="headerlink" href="#pfasst.runner.Runner" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic PFASST driver.</p>
<dl class="method">
<dt id="pfasst.runner.Runner.allocate">
<tt class="descname">allocate</tt><big>(</big><em>dtype</em><big>)</big><a class="headerlink" href="#pfasst.runner.Runner.allocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate storage space.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.runner.Runner.run">
<tt class="descname">run</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.runner.Runner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run.</p>
<p>See <a class="reference internal" href="#pfasst.pfasst.PFASST.run" title="pfasst.pfasst.PFASST.run"><tt class="xref py py-meth docutils literal"><span class="pre">run()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.runner.Runner.sanity_checks">
<tt class="descname">sanity_checks</tt><big>(</big><big>)</big><a class="headerlink" href="#pfasst.runner.Runner.sanity_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform sanity checks before running.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pfasst.serial"></span><p>PyPFASST serial PFASST class.</p>
<dl class="class">
<dt id="pfasst.serial.SerialRunner">
<em class="property">class </em><tt class="descclassname">pfasst.serial.</tt><tt class="descname">SerialRunner</tt><a class="headerlink" href="#pfasst.serial.SerialRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Serial PFASST class/driver.</p>
<dl class="method">
<dt id="pfasst.serial.SerialRunner.run">
<tt class="descname">run</tt><big>(</big><em>u0</em>, <em>dt</em>, <em>tend</em>, <em>iterations</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.serial.SerialRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run in serial (SDC).</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pfasst.parallel"></span><p>PyPFASST ParallelRunner class.</p>
<dl class="class">
<dt id="pfasst.parallel.ParallelRunner">
<em class="property">class </em><tt class="descclassname">pfasst.parallel.</tt><tt class="descname">ParallelRunner</tt><a class="headerlink" href="#pfasst.parallel.ParallelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallel PFASST class/driver.</p>
<dl class="method">
<dt id="pfasst.parallel.ParallelRunner.cycles">
<tt class="descname">cycles</tt><big>(</big><em>cycle</em><big>)</big><a class="headerlink" href="#pfasst.parallel.ParallelRunner.cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Build cycles.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.parallel.ParallelRunner.iteration">
<tt class="descname">iteration</tt><big>(</big><em>k</em>, <em>t0</em>, <em>dt</em>, <em>cycles</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.parallel.ParallelRunner.iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one PFASST iteration.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.parallel.ParallelRunner.predictor">
<tt class="descname">predictor</tt><big>(</big><em>t0</em>, <em>dt</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.parallel.ParallelRunner.predictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the PFASST predictor.</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.parallel.ParallelRunner.run">
<tt class="descname">run</tt><big>(</big><em>u0</em>, <em>dt</em>, <em>tend</em>, <em>iterations</em>, <em>cycle='V'</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.parallel.ParallelRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run in parallel (PFASST).</p>
</dd></dl>

<dl class="method">
<dt id="pfasst.parallel.ParallelRunner.set_initial_conditions">
<tt class="descname">set_initial_conditions</tt><big>(</big><em>u0</em>, <em>t0</em>, <em>dt</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.parallel.ParallelRunner.set_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set initial conditions.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pfasst.parallel.eval_at_sdc_nodes">
<tt class="descclassname">pfasst.parallel.</tt><tt class="descname">eval_at_sdc_nodes</tt><big>(</big><em>t0</em>, <em>dt</em>, <em>qSDC</em>, <em>fSDC</em>, <em>F</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pfasst.parallel.eval_at_sdc_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate implicit/explicit functions at each SDC substep.</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">PFASST</a></li>
<li class="toctree-l1"><a class="reference internal" href="maths.html">Maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#top-level-classes">Top-level classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pfasst-class">PFASST class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#feval-class">FEval class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sdc-class">SDC class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-class">Level class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helpers">Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.imex">IMEX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.explicit">Explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mpi">MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#low-level-routines-guts">Low-level routines (guts)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.interpolate">Interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.restrict">Restrict</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state">State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.fas">FAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pfasst.runner">Runners</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="overview.html" title="Overview"
             >previous</a> |</li>
        <li><a href="index.html">PFASST v0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Matthew Emmett.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>