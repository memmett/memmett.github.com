

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Effect of multiple SDC sweeps per coarse propagation step &mdash; PFASST v0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <link rel="top" title="PFASST v0.0.1 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">PFASST v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="effect-of-multiple-sdc-sweeps-per-coarse-propagation-step">
<h1>Effect of multiple SDC sweeps per coarse propagation step<a class="headerlink" href="#effect-of-multiple-sdc-sweeps-per-coarse-propagation-step" title="Permalink to this headline">Â¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Matthew Emmett</td>
</tr>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">February 23 2011</td>
</tr>
</tbody>
</table>
<p>The effect of using a more accurate coarse propagator can be seen by
performing multiple SDC sweeps during each coarse propagation step.</p>
<p>Consider, for example, the viscous Burger&#8217;s equation given by</p>
<div class="math">
\[u_t + u \nabla u = \nu \nabla^2 u.\]</div>
<p>This equation is split into explicit and implicit parts according to</p>
<div class="math">
\[\begin{split}\begin{align*}
  f_1 &amp;= -u \, \nabla u \
  f_2 &amp;= \nu \nabla^2 u
\end{align*}\end{split}\]</div>
<p>That is, the non-linear advection term is treated explicitly while the
linear diffusion term is treated implicitly.  To minimize spatial
errors (under-resolved problems will be explored later): periodic
boundary conditions are used, all spatial operators are evaluated
spectrally, and the computational grid is chosen so that the problem
is well-resolved.  The initial condition used throughout is</p>
<div class="math">
\[u_0(x) = \exp( -x^2 / \sigma ).\]</div>
<div class="figure align-center">
<img alt="Error vs time for various iterations" src="../_images/error_vs_time5.png" style="width: 691px;" />
<p class="caption">Figure 1.  Maximum absolute error vs time for several PFASST
iterations.  The left and right panels show PFASST errors for one
and two SDC sweeps per coarse (<span class="math">\(\mathcal{G}\)</span>) propagation
step respectively.  Each black line represents the error at the end
of the corresponding PFASST iteration.  The PFASST simulation is
comprised of two levels: fine (<span class="math">\(\mathcal{F}\)</span>) and coarse
(<span class="math">\(\mathcal{G}\)</span>).  The red and blue lines represent the error
of serial runs on the fine and coarse levels with varying numbers
of SDC sweeps per time step (starting with one sweep for the
topmost line).  The fine level is: 512 spatial points and 5
Gauss-Lobatto SDC nodes.  The coarse level is: 256 spatial points
and 3 Gauss-Lobatto SDC nodes.  The PFASST runs were performed with
64 processors.  Parameter values used were: <span class="math">\(\nu =\)</span> 0.005,
and <span class="math">\(\sigma =\)</span> 0.004.</p>
</div>
<p>Figure 1 shows two important results.  First, that the PFASST
algorithm achieves the accuracy of the fine serial run despite the
relatively poor accuracy of the coarse propagator (the coarse serial
runs stop becoming more accurate after 5 SDC sweeps).  For
well-resolved problems the accuracy of the PFASST algorithm is
determined by the accuracy of the fine level, not the coarse level.</p>
<p>Second, that using two SDC sweeps per coarse propagation step reduces
the number of PFASST iterations needed to obtain a highly accurate
solution from 9 iterations to 4 iterations.  As such, using multiple
SDC sweeps per coarse propagation step accelerates the convergence of
the PFASST method for well-resolved problems and fewer PFASST
iterations are required to achieve high accuracy.  In turn, this
results in a higher parallel speedup.</p>
<p>Using multiple SDC sweeps per fine propagation step does not have a
significant effect on the rate of convergence of the PFASST algorithm.</p>
<div class="figure align-center">
<img alt="Error vs iteration" src="../_images/error_vs_iteration5.png" style="width: 673px;" />
<p class="caption">Figure 2.  Maximum absolute error, residual, and change in fine
initial condition for several PFASST iterations at the final time.
The left and right panels show PFASST errors, residuals, and change
in fine initial conditions for one and two SDC sweeps per coarse
(<span class="math">\(\mathcal{G}\)</span>) propagation step respectively.  The PFASST
simulation is comprised of two levels: fine (<span class="math">\(\mathcal{F}\)</span>)
and coarse (<span class="math">\(\mathcal{G}\)</span>).  The red and blue lines represent
the error of serial runs on the fine and coarse levels with varying
numbers of SDC sweeps per time step (starting with one sweep for
the topmost line).  The fine level is: 512 spatial points and 5
Gauss-Lobatto SDC nodes.  The coarse level is: 256 spatial points
and 3 Gauss-Lobatto SDC nodes.  The PFASST runs were performed with
64 processors with a final time of <span class="math">\(T_{\rm end} =\)</span> 0.04.
Parameter values used were: <span class="math">\(\nu =\)</span> 0.005, and <span class="math">\(\sigma
=\)</span> 0.004.</p>
</div>
<p>Figure 2 shows several interesting features.  First, as was
demonstrated in Figure 1, that the PFASST algorithm achieves the
accuracy of the fine serial run despite the relatively poor accuracy
of the coarse propagator; and that the convergence of the PFASST
algorithm is accelerated by using two SDC sweeps per coarse
propagation step.</p>
<p>Second, that the predictor is more accurate than simply performing
single SDC sweeps in serial.</p>
<p>Third, that for well-resolved problems the residual and change in
initial condition are good indications of the error up to a certain
point.  Using the residual and change in initial condition to
adaptively control the number of iterations used will be explored
later.</p>
<div class="figure align-center">
<img alt="Error vs iteration for various numbers of processors" src="../_images/error_vs_iteration_proc5.png" style="width: 668px;" />
<p class="caption">Figure 3.  Maximum absolute error for several PFASST iterations and
number of processors.  The left panel shows PFASST errors at the
final time for a fixed final time.  The right panel shows PFASST
errors at the final time for a fixed time step.  In each panel, the
fine level is: 512 spatial points and 5 Gauss-Lobatto SDC nodes.
The coarse level is: 256 spatial points and 3 Gauss-Lobatto SDC
nodes.  Parameter values used were: <span class="math">\(\nu =\)</span> 0.005, and
<span class="math">\(\sigma =\)</span> 0.004.</p>
</div>
<p>Finally, Figure 3 shows how the PFASST algorithm performs for various
numbers of processors.</p>
<p>When the final time is fixed so that increasing the number of
processors used decreases the time step, the overall accuracy of the
PFASST algorithm improves (up to the point where spatial error
dominates) and the number of PFASST iterations required to achieve a
given level of accuracy decreases.</p>
<p>When the time step is fixed so that increasing the number of
processors used extends the solution to later final times, the
convergence is similar for each run regardless of the final time.
That is, for well-resolved problems the convergence depends largely on
the time step used, not on the number of processors.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">PFASST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maths.html">Maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">PFASST v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Matthew Emmett.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>